- hosts: all
  user: ec2-user
  sudo: yes
  vars:
    nginx_src: 'etc/nginx.conf'
    nginx_dest: '/etc/nginx/nginx.conf'
    nginx_log_dir: '/var/log/nginx'
  tasks:
    - name: Install nginx
      yum: name=nginx state=present
    - name: mkdir nginx log dir
      file:
        dest="{{nginx_log_dir}}" state=directory
        group=nginx owner=nginx
    - name: put nginx.conf to /etc/nginx/nginx.conf
      copy:
        src="{{nginx_src}}"
        dest="{{nginx_dest}}"
    - name: restart nginx
      command: /etc/init.d/nginx restart
